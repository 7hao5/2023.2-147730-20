{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst handlePubrel = (client, packet, done) => {\n  client.log('handling pubrel packet');\n  const callback = typeof done !== 'undefined' ? done : client.noop;\n  const {\n    messageId\n  } = packet;\n  const comp = {\n    cmd: 'pubcomp',\n    messageId\n  };\n  client.incomingStore.get(packet, (err, pub) => {\n    if (!err) {\n      client.emit('message', pub.topic, pub.payload, pub);\n      client.handleMessage(pub, err2 => {\n        if (err2) {\n          return callback(err2);\n        }\n        client.incomingStore.del(pub, client.noop);\n        client['_sendPacket'](comp, callback);\n      });\n    } else {\n      client['_sendPacket'](comp, callback);\n    }\n  });\n};\nexports.default = handlePubrel;","map":{"version":3,"names":["handlePubrel","client","packet","done","log","callback","noop","messageId","comp","cmd","incomingStore","get","err","pub","emit","topic","payload","handleMessage","err2","del","exports","default"],"sources":["C:\\Users\\vuhuy\\OneDrive - Hanoi University of Science and Technology\\NEWCODE\\ITSS_JP_2\\node_modules\\mqtt\\src\\lib\\handlers\\pubrel.ts"],"sourcesContent":["import { IPubcompPacket, IPublishPacket, IPubrelPacket } from 'mqtt-packet'\r\nimport { PacketHandler } from '../shared'\r\n\r\nconst handlePubrel: PacketHandler = (client, packet: IPubrelPacket, done) => {\r\n\tclient.log('handling pubrel packet')\r\n\tconst callback = typeof done !== 'undefined' ? done : client.noop\r\n\tconst { messageId } = packet\r\n\r\n\tconst comp: IPubcompPacket = { cmd: 'pubcomp', messageId }\r\n\r\n\tclient.incomingStore.get(packet, (err, pub: IPublishPacket) => {\r\n\t\tif (!err) {\r\n\t\t\tclient.emit('message', pub.topic, pub.payload as Buffer, pub)\r\n\t\t\tclient.handleMessage(pub, (err2) => {\r\n\t\t\t\tif (err2) {\r\n\t\t\t\t\treturn callback(err2)\r\n\t\t\t\t}\r\n\t\t\t\tclient.incomingStore.del(pub, client.noop)\r\n\t\t\t\tclient['_sendPacket'](comp, callback)\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tclient['_sendPacket'](comp, callback)\r\n\t\t}\r\n\t})\r\n}\r\n\r\nexport default handlePubrel\r\n"],"mappings":";;;;;AAGA,MAAMA,YAAY,GAAkBA,CAACC,MAAM,EAAEC,MAAqB,EAAEC,IAAI,KAAI;EAC3EF,MAAM,CAACG,GAAG,CAAC,wBAAwB,CAAC;EACpC,MAAMC,QAAQ,GAAG,OAAOF,IAAI,KAAK,WAAW,GAAGA,IAAI,GAAGF,MAAM,CAACK,IAAI;EACjE,MAAM;IAAEC;EAAS,CAAE,GAAGL,MAAM;EAE5B,MAAMM,IAAI,GAAmB;IAAEC,GAAG,EAAE,SAAS;IAAEF;EAAS,CAAE;EAE1DN,MAAM,CAACS,aAAa,CAACC,GAAG,CAACT,MAAM,EAAE,CAACU,GAAG,EAAEC,GAAmB,KAAI;IAC7D,IAAI,CAACD,GAAG,EAAE;MACTX,MAAM,CAACa,IAAI,CAAC,SAAS,EAAED,GAAG,CAACE,KAAK,EAAEF,GAAG,CAACG,OAAiB,EAAEH,GAAG,CAAC;MAC7DZ,MAAM,CAACgB,aAAa,CAACJ,GAAG,EAAGK,IAAI,IAAI;QAClC,IAAIA,IAAI,EAAE;UACT,OAAOb,QAAQ,CAACa,IAAI,CAAC;;QAEtBjB,MAAM,CAACS,aAAa,CAACS,GAAG,CAACN,GAAG,EAAEZ,MAAM,CAACK,IAAI,CAAC;QAC1CL,MAAM,CAAC,aAAa,CAAC,CAACO,IAAI,EAAEH,QAAQ,CAAC;MACtC,CAAC,CAAC;KACF,MAAM;MACNJ,MAAM,CAAC,aAAa,CAAC,CAACO,IAAI,EAAEH,QAAQ,CAAC;;EAEvC,CAAC,CAAC;AACH,CAAC;AAEDe,OAAA,CAAAC,OAAA,GAAerB,YAAY","ignoreList":[]},"metadata":{},"sourceType":"script","externalDependencies":[]}